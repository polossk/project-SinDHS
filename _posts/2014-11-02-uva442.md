---
layout: post
title: "UVa 442 Matrix Chain Multiplication 表达式模拟"
date: 2014-11-02 19:57:05 +0800
categories: contest algorithm
tags: acmicpc uva sims
---
题目地址<a title="UVa 442" href="http://uva.onlinejudge.org/index.php?option=com_onlinejudge&Itemid=8&category=103&page=show_problem&problem=383" target="_blank">-></a>

先告诉你矩阵的大小，然后判断是否能够使得表达式匹配。直接用堆栈模拟下就好了。注意中间判断矩阵到底能不能乘。

Code Here
{% highlight cpp %}
#include <cstdio>
#include <stack>
#include <string.h>
using namespace std;

typedef struct
{
	int w;
	int h;
} matrix;

matrix mat[30];

int main()
{
	int n;
	char c[1000];
	int m,nn,l;
	long long ans;

	matrix m1,m2,m3;
	scanf("%d",&n);
	memset(mat,0,sizeof(mat));
	for(int i=0;i<n;i++)
	{
		scanf("%s%d%d",c,&m,&nn);
		mat[c[0]-'A'].w=m;
		mat[c[0]-'A'].h=nn;
	}
	while(scanf("%s",c)!=EOF)
	{
		ans=0;
		stack<matrix> s;
		l=strlen(c);

		for(int i=0;i<l;i++)
		{
			if(c[i]=='(')
				continue;

			if(c[i]==')')
			{

				m2=s.top();
				s.pop();
				m1=s.top();
				s.pop();

				if(m1.h!=m2.w)
				{
					ans=-1;
					break;
				}
				ans+=m1.w*m1.h*m2.h;
				m1.h=m2.h;
				s.push(m1);

				continue;
			}
			s.push(mat[c[i]-'A']);

		}
		if(ans==-1)
		{
			printf("error\n");
			continue;
		}
		printf("%lld\n",ans);
	}
	return 0;
}{% endhighlight %}
